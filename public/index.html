<!DOCTYPE html>
<!-- <!DOCTYPE html> -->
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="shortcut icon" href="<%= webpackConfig.output.publicPath %>favicon.ico">
    <title>web-console</title>
    <style>
      /* CSSImportRule */
      @import url('style_import.css');

      /* CSSStyleRule */
      #element {
        color: red;
        animation: out; 
      }
      .xyz {
        border: 1px solid red;
      }
      div {
        color: black;
      }

      /* CSSKeyframesRule */
      @keyframes out {
        0% { }
        100% { opacity: 0; }
      }

      /* parent element style */
      #parent {
        /* 可继承 */
        color: gold;
        /* 不可继承 */
        border-right-width: 1px;
      }

      #parent2 {
        color: brown;
        /* 不可继承 */
        border-right-width: 2px;
      }
    </style>
    <link rel="stylesheet" href="style_link.css">
    <link rel="stylesheet" href="./mint-ui.min.css">
    <style>
      #app {
        height: 100%;
        overflow-y: scroll;
      }

      #app .mint-button {
        width: 100%;
        margin-bottom: 15px;
      }
    </style>
  </head>
  <body>
    <!-- 测试 element 面板 -->
    <div id="parent" style="color: red">
      <div id="parent2" style="color: red">
        <div id="element"
          class="xyz"
          style="display: none"
          data-a="a"
          >
          <div> 
            <!-- 测试不同类型节点 -->
              hello 
              world
            <span>b</span>
            <!-- 无内容标签测试 -->
            <input>
            <input/>
            <input></input>
          </div>
          1
          <div>
            2
            <div>
              3
              <div>
                4
                <div>
                  5
                  <div>
                    6
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- import Vue before Mint UI -->
    <script src="./vue.js"></script>
    <div id="app">
      <h1>WebConsole</h1>
      <div v-if="isDev">
        <h2>Console Test</h2>
        <mt-button type="primary" @click="onClickPrint('log_level')">打印不同级别日志</mt-button>
        <mt-button type="primary" @click="onClickPrint('log_params')">打印多参数</mt-button>
        <mt-button type="primary" @click="$console.testFormat()">打印格式化</mt-button>
        <mt-button type="primary" @click="$console.testObject()">打印对象</mt-button>
        <mt-button type="primary" @click="$console.testException()">触发异常</mt-button>
        <h2>Network Test</h2>
        <mt-button type="primary" @click="$network.testHTTPStatus()">测试 HTTP 状态码</mt-button>
        <mt-button type="primary" @click="$network.testRequestParams()">测试请求参数</mt-button>
        <mt-button type="primary" @click="$network.testResponseData()">测试响应数据</mt-button>
        <mt-button type="primary" @click="onClickAjax('xhr_get')">发起 GET 请求</mt-button>
        <mt-button type="primary" @click="onClickAjax('xhr_post')">发起 POST 请求</mt-button>

        <h2>Application Test</h2>
        <mt-button type="primary" @click="$application.testWriteCookie(1000)">测试 Cookie</mt-button>
        <mt-button type="primary" @click="$application.testWriteLocalStorage(1000)">测试 LocalStorage</mt-button>
        <mt-button type="primary" @click="$application.testWriteSessionStorage(1000)">测试 SessionStorage</mt-button>
        <h2>Other</h2>
        <mt-button type="primary" @click="performanceTest(50)">日志性能测试</mt-button>
      </div>
      <div v-else>
        <mt-button type="primary" @click="onClickPrint('log')">普通日志(log)</mt-button>
        <mt-button type="primary" @click="onClickPrint('info')">信息日志(info)</mt-button>
        <mt-button type="primary" @click="onClickPrint('debug')">调试日志(debug)</mt-button>
        <mt-button type="primary" @click="onClickPrint('warn')">警告日志(warn)</mt-button>
        <mt-button type="primary" @click="onClickPrint('error')">报错日志(error)</mt-button>

        <mt-button type="default" @click="onClickPrint('log_params')">打印多参数</mt-button>
        <mt-button type="default" @click="$console.testObject()">打印对象</mt-button>

        <mt-button type="default" @click="onClickAjax('xhr_get')">发起 GET 请求</mt-button>
        <mt-button type="default" @click="onClickAjax('xhr_post')">发起 POST 请求</mt-button>
      </div>
      <mt-switch v-model='isDev'>切换</mt-switch>
    </div>
    <!-- import JavaScript -->
    <script src="./mint-ui.min.js"></script>
    <script src="./test_console.js"></script>
    <script src="./test_network.js"></script>
    <script src="./test_application.js"></script>
    <script type="text/javascript">
      new Vue({
        el: "#app",
        data: function() {
          return {
            // isDev: false
            isDev: true
          };
        },
        computed: {
          $network () {
            return window.$network
          },
          $console () {
            return window.$console
          },
          $application () {
            return window.$application
          }
        },
        mounted: function() {
          this.launchWebConsole();
        },
        methods: {
          performanceTest (n) {
            if (n <= 0) return
            this.$console.testFormat()
            // this.$network.testHTTPStatus()
            var that = this
            that.performanceTest(n - 1)
            // setTimeout(function () {
            //   that.performanceTest(n - 1)
            // }, 10)
          },
          launchWebConsole: function() {
            var self = this;
            if (window.WebConsole) {
              // 测试 web-console 加载完毕前的日志输出
              // console.error(new Error('hello'))

              // 测试日志数量
              // new Array(11).fill(0).forEach((v, i) => console.log(i))

              window.webConsole = new window.WebConsole({
                activeTab: 'element',
                panelVisible: true,
                entryStyle: 'icon'
              });
              // this.$console.testFormat()
              // this.$network.testHTTPStatus()
              // this.$network.testRequestParams()
              this.$network.testResponseData()
              // this.$console.testIntervalLog()
            } else {
              setTimeout(function() {
                self.launchWebConsole();
              }, 200);
            }
          },
          onClickPrint: function(type) {
            var numInt = 1;
            var numFloat = 1.23;
            var str = "hello";
            var obj = {
              a: 1,
              b: 2,
              c: {
                d: 3
              }
            };
            var arr = [1, 2, [3, obj]];
            switch (type) {
              case "log":
                console.log("log");
                break;
              case "info":
                console.info("info");
                break;
              case "debug":
                console.debug("debug");
                break;
              case "warn":
                console.warn("warn");
                break;
              case "error":
                console.error("error");
                break;
              case "log_level":
                console.log("log");
                console.info("info");
                console.debug("debug");
                console.warn("warn");
                console.error("error");
                break;
              case "log_params":
                console.log("aa", 100, true, null, undefined, { a: "a" }, Symbol());
                break;
            }
          },
          onClickAjax(type) {
            var server = "http://localhost:8090";
            switch (type) {
              case "xhr_get":
                var xhr = new window.XMLHttpRequest();
                xhr.open("GET", server + "/get");
                xhr.onreadystatechange = function() {
                  console.log("readyState:", this.readyState);
                };
                xhr.send();

                ajax({
                  url: "http://mta.qq.com/h5/api/ctr_core_data"
                });
                // setTimeout(() => {
                //   xhr.onreadystatechange = function () {
                //     console.log('readyState:', this.readyState)
                //   }
                // })
                break;
              case "xhr_post":
                // var xhr = new window.XMLHttpRequest()
                // xhr.open('POST', server + '/post')
                // const data = {
                //   name: 'whincwu'
                // }
                // xhr.send(JSON.stringify(data))
                break;
            }
          }
        }
      });

      function ajax(options) {
        options = options || {};
        var url = options.url;
        var method = options.method || "GET";

        var xhr = new window.XMLHttpRequest();
        xhr.onreadystatechange = function() {
          console.log("readyState:", this.readyState);
        };
        xhr.open(method, url);
        xhr.send();
      }

      // 测试log格式化输出
      function testLogFormat(value, format) {
        console.log("console.log(%" + format + ", %s)", JSON.stringify(value));
        console.log(format, value);
      }
    </script>
    <!-- <script src="https://unpkg.com/@whinc/web-console"></script> -->
    <script src="http://res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/vconsole/3.0.0/vconsole.min.js"></script>
    <script>
      var vConsole = new window.VConsole();
    </script>
    <!-- built files will be auto injected -->
  </body>
</html>
